<!DOCTYPE html>
<html>
    <head>
        <!--Writing all the required stuff in the meta description tags-->  
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name = "description" content="A simple web chat application for a course project">
        <meta name = "keywords" content = "chat, iitk, esc101, ayush, advanced, track">
        <meta name = "author" content="Ayush Gupta">

        <title>WebSockets - Simple chat</title> 

        <!--TODO: add links to a stylesheet-->
        <script type="application/javascript">
        var ws;

        function init() {
            var servermsg = document.getElementById("servermsg");
            ws = new WebSocket("ws://127.0.0.1:9877/");
            ws.onopen = function(){
                servermsg.innerHTML = servermsg.innerHTML + "<br>Server connected";
            };
            ws.onmessage = function(e){
                servermsg.innerHTML = servermsg.innerHTML + "<br><< Recieved data: " + e.data;
            };
            ws.onclose = function(){
                servermsg.innerHTML = servermsg.innerHTML + "<br>Server disconnected";
            };
        }
        function postmsg(){
            var text = document.getElementById("message").value;
            ws.send(text);
            servermsg.innerHTML = servermsg.innerHTML + "<br>>> Data sent: " + text;
        }
        //$(function(){
        //    var text = document.getElementById("message").value;
        //    ws.send(text);
        //    servermsg.innerHTML = servermsg.innerHTML + "<br>Sent: " + text;            
        //});


    </script>
</head>
<body onload="init();">
    <form action="" onSubmit="postmsg();return false;">
        <input type="text" name="message" value="" id="message">
        <input type="submit" name="submit" value="" id="submit">
    </form>
    <div id="servermsg"><h1>Message log:</h1></div>
</body>

</html>